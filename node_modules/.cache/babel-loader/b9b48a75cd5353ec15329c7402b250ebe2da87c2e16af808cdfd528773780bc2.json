{"ast":null,"code":"import ColorSpace from \"../space.js\";\nimport { WHITES } from \"../adapt.js\";\nimport xyz_d50 from \"./xyz-d50.js\";\n\n// κ * ε  = 2^3 = 8\nconst ε = 216 / 24389; // 6^3/29^3 == (24/116)^3\nconst ε3 = 24 / 116;\nconst κ = 24389 / 27; // 29^3/3^3\n\nlet white = WHITES.D50;\nexport default new ColorSpace({\n  id: \"lab\",\n  name: \"Lab\",\n  coords: {\n    l: {\n      refRange: [0, 100],\n      name: \"Lightness\"\n    },\n    a: {\n      refRange: [-125, 125]\n    },\n    b: {\n      refRange: [-125, 125]\n    }\n  },\n  // Assuming XYZ is relative to D50, convert to CIE Lab\n  // from CIE standard, which now defines these as a rational fraction\n  white,\n  base: xyz_d50,\n  // Convert D50-adapted XYX to Lab\n  //  CIE 15.3:2004 section 8.2.1.1\n  fromBase(XYZ) {\n    // compute xyz, which is XYZ scaled relative to reference white\n    let xyz = XYZ.map((value, i) => value / white[i]);\n\n    // now compute f\n    let f = xyz.map(value => value > ε ? Math.cbrt(value) : (κ * value + 16) / 116);\n    return [116 * f[1] - 16,\n    // L\n    500 * (f[0] - f[1]),\n    // a\n    200 * (f[1] - f[2]) // b\n    ];\n  },\n  // Convert Lab to D50-adapted XYZ\n  // Same result as CIE 15.3:2004 Appendix D although the derivation is different\n  // http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html\n  toBase(Lab) {\n    // compute f, starting with the luminance-related term\n    let f = [];\n    f[1] = (Lab[0] + 16) / 116;\n    f[0] = Lab[1] / 500 + f[1];\n    f[2] = f[1] - Lab[2] / 200;\n\n    // compute xyz\n    let xyz = [f[0] > ε3 ? Math.pow(f[0], 3) : (116 * f[0] - 16) / κ, Lab[0] > 8 ? Math.pow((Lab[0] + 16) / 116, 3) : Lab[0] / κ, f[2] > ε3 ? Math.pow(f[2], 3) : (116 * f[2] - 16) / κ];\n\n    // Compute XYZ by scaling xyz by reference white\n    return xyz.map((value, i) => value * white[i]);\n  },\n  formats: {\n    \"lab\": {\n      coords: [\"<number> | <percentage>\", \"<number> | <percentage>[-1,1]\", \"<number> | <percentage>[-1,1]\"]\n    }\n  }\n});","map":{"version":3,"names":["ColorSpace","WHITES","xyz_d50","ε","ε3","κ","white","D50","id","name","coords","l","refRange","a","b","base","fromBase","XYZ","xyz","map","value","i","f","Math","cbrt","toBase","Lab","pow","formats"],"sources":["/Users/lyuchaeeun/Desktop/unsaengdong/node_modules/colorjs.io/src/spaces/lab.js"],"sourcesContent":["import ColorSpace from \"../space.js\";\nimport {WHITES} from \"../adapt.js\";\nimport xyz_d50 from \"./xyz-d50.js\";\n\n// κ * ε  = 2^3 = 8\nconst ε = 216 / 24389;  // 6^3/29^3 == (24/116)^3\nconst ε3 = 24 / 116;\nconst κ = 24389 / 27;   // 29^3/3^3\n\nlet white = WHITES.D50;\n\nexport default new ColorSpace({\n\tid: \"lab\",\n\tname: \"Lab\",\n\tcoords: {\n\t\tl: {\n\t\t\trefRange: [0, 100],\n\t\t\tname: \"Lightness\",\n\t\t},\n\t\ta: {\n\t\t\trefRange: [-125, 125],\n\t\t},\n\t\tb: {\n\t\t\trefRange: [-125, 125],\n\t\t},\n\t},\n\n\t// Assuming XYZ is relative to D50, convert to CIE Lab\n\t// from CIE standard, which now defines these as a rational fraction\n\twhite,\n\n\tbase: xyz_d50,\n\t// Convert D50-adapted XYX to Lab\n\t//  CIE 15.3:2004 section 8.2.1.1\n\tfromBase (XYZ) {\n\t\t// compute xyz, which is XYZ scaled relative to reference white\n\t\tlet xyz = XYZ.map((value, i) => value / white[i]);\n\n\t\t// now compute f\n\t\tlet f = xyz.map(value => value > ε ? Math.cbrt(value) : (κ * value + 16) / 116);\n\n\t\treturn [\n\t\t\t(116 * f[1]) - 16,   // L\n\t\t\t500 * (f[0] - f[1]), // a\n\t\t\t200 * (f[1] - f[2]),  // b\n\t\t];\n\t},\n\t// Convert Lab to D50-adapted XYZ\n\t// Same result as CIE 15.3:2004 Appendix D although the derivation is different\n\t// http://www.brucelindbloom.com/index.html?Eqn_RGB_XYZ_Matrix.html\n\ttoBase (Lab) {\n\t\t// compute f, starting with the luminance-related term\n\t\tlet f = [];\n\t\tf[1] = (Lab[0] + 16) / 116;\n\t\tf[0] = Lab[1] / 500 + f[1];\n\t\tf[2] = f[1] - Lab[2] / 200;\n\n\t\t// compute xyz\n\t\tlet xyz = [\n\t\t\tf[0]   > ε3 ? Math.pow(f[0], 3)                : (116 * f[0] - 16) / κ,\n\t\t\tLab[0] > 8  ? Math.pow((Lab[0] + 16) / 116, 3) : Lab[0] / κ,\n\t\t\tf[2]   > ε3 ? Math.pow(f[2], 3)                : (116 * f[2] - 16) / κ,\n\t\t];\n\n\t\t// Compute XYZ by scaling xyz by reference white\n\t\treturn xyz.map((value, i) => value * white[i]);\n\t},\n\n\tformats: {\n\t\t\"lab\": {\n\t\t\tcoords: [\"<number> | <percentage>\", \"<number> | <percentage>[-1,1]\", \"<number> | <percentage>[-1,1]\"],\n\t\t},\n\t},\n});\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}